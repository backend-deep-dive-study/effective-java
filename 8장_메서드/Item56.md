# 공개된 API 요소에는 항상 문서화 주석을 작성하라

### Javadoc

- API 문서는 코드가 변경되면 함께 수정 필요 → 자바독 유틸리티가 도와줌
- 소스코드 파일에서 문서화 주석이라는 형태로 기술된 설명을 추려 API 문서로 변환
- 중요한 자바독 태그
    - `@literal` , `@code` , `@implSpce` , `@index`

### API를 올바르게 문서화하려면 공개된 모든 클래스, 인터페이스, 메서드, 필드 선언에 문서화 주석 필요

- 직렬화할 수 있는 클래스라면 직렬화 형태에 관해서도 기재
- 문서화 주석이 없으면 자바독도 공개 API 요소들의 선언만 나열
- 기본 생성자에는 문서화 주석 작성 불가 → 공개 클래스는 절대.. 기본 생성자 사용하면 안됨

### 메서드용 문서화 주석에는 해당 메서드와 클라이언트 사이의 규약을 명료하게 기술

- 상속용으로 설계된 클래스의 메서드가 아니라면 (그 메서드가 어떻게(how) 동작하는지가 아니라) 무엇을(what) 하는지를 기술
- 클라이언트가 해당 메서드를 호출하기 위한 전제조건 모두 나열
    - `@throws` 로 비검사 예외를 선언하여 암시적으로 기수 (비검사 예외 1개 → 전제조건 1개 연결)
    - `@param` 으로 그 조건에 영향받는 매개변수에 기술
- 메서드가 성공적으로 수행된 후에 만족해야 하는 사후조건 모두 나열
- 부작용도 문서화 필요
    - 부작용: 사후조건으로 명확히 나타나지 않지만 시스템의 상태에 변화를 가져오는 것
    - ex) 백그라운드 스레드를 시작시키는 메서드

### 메서드 계약 완벽히 기술

- `@param` : 모든 매개변수에 붙이기
- `@return` : 반환 타입이 void가 아니라면 붙이기
- `@throws` : 발생할 가능성이 있는 모든 예외에 붙이기

### 문서화 주석 태그 규칙

- `@return` 태그의 설명이 메서드 설명과 같을 경우 생략 가능
- `@param` , `@return` 태그의 설명은 해당 매개변수가 뜻하는 값이나 반환값을 설명하는 명사구 작성
    - 산술 표현식도 작성 가능 ex) BigInteger API 문서 참고
- `@throws` 는 if로 시작해 해당 예외를 던지는 조건을 설명
- `@param` , `@return` , `@throws` 태그의 설명에는 마침표X

### 규칙이 모두 반영된 문서화 주석 예시

```java
/**
* 이 리스트에서 지정한 위치의 원소를 반환한다.
*
* <p>이 메서드는 상수 시간에 수행됨을 보장하지 <i>않는다</i>. 구현에 따라
* 원소의 위치에 비례해 시간이 걸릴 수도 있다.
*
* @param index 반환할 원소의 인덱스; 0 이상이고 리스트 크기보다 작아야 한다.
* @return 이 리스트에서 지정한 위치의 원소
* @throws IndexOutOfBoundsException index가 범위를 벗어나면,
* 즉, ({@code index < 0 || index >= this.size()})이면 발생한다.
*/
E get(int index);
```

- 자바독 유틸리티는 문서화 주석을 HTML로 변환 → 문서화 주석 안의 HTML 요소들이 최종 HTML 문서에 반영 (표도 넣을 수 있음)
- `@throws` 에 사용한 `{@code}` 태그
    - 태그로 감싼 내용을 코드용 폰트로 렌더링
    - 태그로 감싼 내용에 포함된 HTML 요소나 다른 자바독 태그 무시 → HTML 메타문자인 < 기호를 별다른 처리없이 사용 가능
    - 여러 줄로 된 코드 예시를 넣으려면 `{@code}` 태그를 `<pre>` 태그로 감싸기
        - `<pre>{@code … 코드 … } </pre>`
    - @ 기호에는 무조건 탈출문자를 붙여야 하니 문서화 주석 안의 코드에서 애너테이션 사용 시 주의
        - `&#64;` 로 사용
- this list: 인스턴스 메서드의 문서화 주석에 쓰인 this는 호출된 메서드가 자리하는 객체를 가리킴

### 상속용 클래스

- 자기사용 패턴에 대해 문서화 필요 → 해당 메서드를 올바르게 재정의하는 방법 명시
- `@implSpec` : 자기사용 패턴 문서화 태그
- 해당 메서드와 하위 클래스 사이의 계약을 설명
- 하위 클래스들이 해당 메서드를 상속하거나 super 키워드를 이용해 호출할 때 그 메서드가 어떻게 동작하는지를 명확히 인지하고 사용할 수 있도록 함

```java
/**
* 이 컬렉션이 비었다면 true를 반환한다.
*
* @implSpec
* 이 구현은 {@code this.size() == 0}의 결과를 반환한다.
* 
* @return 이 컬렉션이 비었다면 true, 그렇지 않으면 false
*/
public boolean isEmpty() { ... }
```

- -tag "impISpec:a:Implementation Requirements:" 를 켜주지 않으면 `@implSpec` 태그 무시

### HTML 메타문자 포함

- API 설명에 <, >, & 등의 HTML 메타문자 포함시키려면 특별 처리 필요
- `{@literal}` : HTML 마크업이나 자바독 태그를 무시하게 해줌

```java
/**
* {@literal |r| < 1}이면 기하 수열이 수렴한다.
*/
```

- < 기호만 감싸도 결과는 같지만 코드에서의 가독성 떨어짐
    - 1순위: API 문서 가독성
    - 2순위: 코드에서의 가독성

### 요약 설명

- 각 문서화 주석의 첫 번째 문장은 해당 요소의 요약 설명으로 간주
- 대상의 기능을 고유하게 기술
    - 한 클래스 안에서 요약 설명이 같은 멤버가 둘 이상이면 안됨
- 마침표, 공백(스페이스, 탭, 줄바꿈), 다음 문장 시작이 나올 경우 요약 설명이 끝났다는 판단
    - 마침표 사용할 경우 `{@literal}` 로 감싸기
- 메서드와 생성자의 요약 설명: 주어가 없는 동사구
- 클래스, 인터페이스, 필드 요약 설명: 대상을 설명하는 명사절

### 검색(색인) 기능

- 자바 9부터 자바독이 생성한 HTML 문서에 검색(색인) 기능이 추가됨
- 클래스, 메서드, 필드 같은 API 요소의 색인 자동 생성
- `{@index}` 태그로 색인 추가 가능

### 제네릭 타입 문서화

- 제네릭 타입이나 제네릭 메서드 문서화 시 모든 타입 매개변수에 주석 작성

```java
/**
* 키와 값을 매핑하는 객체. 맵은 키를 중복해서 가질 수 없다.
* 즉，키 하나가 가리킬 수 있는 값은 최대 1개다.
*
* (나머지 설명은 생략)
*
* @param <K> 이 맵이 관리하는 키의 타입
* @param <V> 매핑된 값의 타입
*/
public interface Map<K, V> { ... }
```

### 열거 타입 문서화

- 열거 타입을 문서화 시 상수들에도 주석 작성

```java
/**
* 심포니 오케스트라의 악기 세션,
*/
public enum OrchestraSection {
	/** 풀루트, 클라리넷, 오보 같은 목관악기. */
	WOODWIND,
	/** 프렌치 호른, 트럼펫 같은 금관악기. */
	BRASS;
}
```

### 애너테이션 타입 문서화

- 애너테이션 타입 문서화 시 멤버들에도 모두 주석 작성
- 애너테이션 타입 자체도 필수
- 필드 설명: 명사구
- 요약 설명: 프로그램 요소에 이 애너테이션을 다는 것이 어떤 의미인지 설명하는 동사구

```java
/**
* 이 애너테이션이 달린 메서드는 명시한 예외를 던져야만 성공하는
* 테스트 메서드임을 나타낸다.
*/
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface ExceptionTest {
	/**
	* 이 애너테이션을 단 테스트 메서드가 성공하려면 던져야 하는 예외,
	* (이 클래스의 하위 타입 예외는 모두 허용된다.)
	*/
	Class<? extends Throwable> value();
}
```

### 패키지 문서화

- package-info.java 파일에 작성
- 패키지 선언 시 필수
- 패키지 선언 관련 애너테이션 추가 포함 가능
- 모듈 시스템도 비슷 → module-info.java 파일에 작성

### 스레드 안전성과 직렬화 가능성

- 스레드 안전 수준을 반드시 API 설명에 기술
    - 클래스 혹은 정적 메서드가 스레드 안전하든 그렇지 않든
- 직렬화할 수 있는 클래스라면 직렬화 형태도 API 설명에 기술

### 자바독 상속

- 자바독은 메서드 주석을 상속시킬 수 있음
- 문서화 주석이 없는 API 요소를 발견하면 자바독이 가장 가까운 문서화 주석 찾아줌
- 상위 클래스보다 그 클래스가 구현한 인터페이스 먼저 찾음
- `{@inheritDoc}` 태그 사용해 상위 타입의 문서화 주석 일부 상속 가능

### 자바독…

- 프로그래머가 자바독 문서를 올바르게 작성했는지 확인
- 해당 아이템에서 소개한 권장사항 중 상당수 검사
- 잘 쓴 문서인지 확인하는 유일한 방법 → 자바독 유틸리티가 생성한 웹페이지 읽어보기

### 정리

- 문서화 주석은 API를 문서화하는 효과적인 방법
- 공개 API일 경우 문서화 주석 필수
- 표준 규약 지키기
- 문서화 주석에 임의의 HTML 태그 사용 가능 (메타문자 특별 취급 필요)
